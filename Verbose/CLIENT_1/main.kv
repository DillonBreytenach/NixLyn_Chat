#: import Button kivy.uix.button.Button
#: import Label kivy.uix.label.Label
#: import Clock kivy.clock.Clock
#: import MDLabel kivymd.uix.label.MDLabel
#: import MDRoundFlatButton kivymd.uix.button.MDRoundFlatButton

#: import MDBoxLayout kivymd.uix.boxlayout.MDBoxLayout


#: import os os
#: import Window kivy.core.window.Window
#: import IconLeftWidget kivymd.uix.list.IconLeftWidget


#-----------------------------------------------------------------------------------------------------

WindowManager:
<WindowManager>:
    Main_WID:
    Login:
    Register:
    Home:
    Contacts:
    Chats:
    New_Log:
    Search:
    Add_C:


#-----------------------------------------------------------------------------------------------------
# ATRIBUTES GLOBAL
<MD_RECT_BUTTON@MDRectangleFlatButton>:
    text_color: (0,0,0,1)
    line_color: (69/255, 245/255, 39/255, 0.99)
    md_bg_color: (69/255, 245/255, 39/255, 0.99)
    ripple_behavior: True
    






#-----------------------------------------------------------------------------------------------------
#POPUPS
    #ERROR/SUCCESSFUL
<Login_Fail>:
    title: "LOGIN_FAIL"
    Button:
        text: "[INCORRECT]:\nPSWD || USERNAME"
        on_release: root.dismiss()
<Reg_Fail>:
    title: "REG_FAIL"
    Button:
        text: "REG_FAIL"
        on_release: root.dismiss()
<Add_fail>:
    title: "NEW_CONTACT_FAIL"
    MDFloatLayout:
        Button:
            text: "ADDING\nCONTACT\nFAILED"
            size_hint: 1, 1
            pos_hint: {'x': 0, 'y': 0}
            on_release: root.dismiss()
<Add_Success>:
    title: "NEW_CONTACT_ADDED"
    MDFloatLayout:
        Button:
            text: "ADDING\nCONTACT\nSUCCESSFUL"
            size_hint: 1, 1
            pos_hint: {'x': 0, 'y': 0}
            on_release: root.dismiss()


#-----------------------------------------------------------------------------------------------------
    #WELCOME
<Welcome>:
    title: ""
    size_hint: 0.5, 0.5
    background_color: 0,0,0,0
    separator_height: 0
    MD_RECT_BUTTON:
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        size_hint: None, None
        font_size: 32
        text: "WELCOME"
        on_release: root.dismiss()

#-----------------------------------------------------------------------------------------------------
    #ADD_CONTACT
<Add_C>:
    name: 'add_c'
    add_ed: self.added_cont

    MDFloatLayout:
        TextInput:
            id: NEW_CONTACT
            size_hint: .6, .2
            pos_hint: {'x': .2, 'y': .6}
        Button:
            text: "BACK"
            size_hint: .1, .1
            pos_hint: {'x': .9, 'y': .9}
            on_release:
                root.back()

        Button:
            text: "ADD"
            size_hint: .6, .2
            pos_hint: {'x': .2, 'y': .3}
            on_release: 
                root.add_c()
                if root.add_ed == '1': print("ADDED")  #root.Add_Success()



#-----------------------------------------------------------------------------------------------------
#SCREENS
#-----------------------------------------------------------------------------------------------------
    #FUNC_S
#-----------------------------------------------------------------------------------------------------

<New_Log>:
    name: 'New_Log'
    MDFloatLayout:

        Button:
            id: NewLog
            text: "NEW_LOG"

        Button:
            id: back
            text: "BACK"
            on_release: root.back()
<Search>:
    name: 'Search'
    MDFloatLayout:

        Button:
            id: SEARCH
            text: "SEARCH"

        Button:
            id: back
            text: "BACK"
            on_release: root.back()

#-----------------------------------------------------------------------------------------------------
    #CONTACTS && CHATS

<Chat_Buttons>:
    # Default style for the button
    font_size: 20
    size_hint: (1, None)
    height: 50
    background_color: (0.5, 0.5, 0.5, 1)
    color: (0, 0, 0, 1)


<TwoButtons>:
# This class is used as the viewclass in the RecycleView
# The means this widget will be instanced to view one element of data from the data list.
# The RecycleView data list is a list of dictionaries.  The keys in the dictionary specify the 
# attributes of the widget.

    font_size: 20
    size_hint: (1.5, None)
    height: 50
    background_color: (0.5, 0.5, 0.5, 1)
    color: (0, 0, 0, 1)
    spacing: 0

    MD_RECT_BUTTON:
        size_hint: 2, None
        text: root.left_text
        on_release: root.go_chat(root.left_text) #, print(f'Button {self.text} pressed')
    MD_RECT_BUTTON:
        text: root.right_text
        on_release: print(f'Button {self.text} pressed') 
        



<Scroll_Me>:
    viewclass: "TwoButtons"
    RecycleBoxLayout:
        default_size: None, None
        default_size_hint: 1, None
        size_hint_y: None
        orientation: 'vertical'
        height: self.minimum_height
        pos_hint: {'center_x': 0.5, 'center_y': 0.4}
        



<Contacts>:
    id: Contacts
    name: 'Contacts'
    scrollerName: Scroll_Me
    MDFloatLayout:

        Scroll_Me:
            pos_hint: {'center_x': 0.5, 'center_y': 0.3}
            id: Scroll_Me

        Button:
            id: USER
            text: "USER"
            size_hint: .6, .1
            pos_hint: {'x': 0.2,'y': 0.9}

        Button:
            id: add
            text: "+"
            size_hint: .2, .1
            pos_hint: {'x': 0.8,'y': 0.9}
            on_release: root.add_c()

        Button:
            id: Home
            text: "Home"
            size_hint: .5, .1
            pos_hint: {'x': 0.0,'y': 0.8}
            on_release: root.home()

        Button:
            id: CONTACTS
            text: "CONTACTS"
            disabled: True
            size_hint: .5, .1
            pos_hint: {'x': 0.5,'y': 0.8}

        Button:
            id: EXIT
            text: "EXIT"
            size_hint: .2, .1
            pos_hint: {'x': 0.0,'y': 0.9}
            on_press: root.back()
        

#-----------------------------------------------------------------------------------------------------
<Chat_Msgs>:
    # Default style for the button
    font_size: 15
    size_hint: (1, None)
    height: self.texture_size[1]
    padding: 0, 15
    background_color: (0.7, 0.9, 1, 1)
    color: (0, 0, 0, 1)



<Scroll_Chats>:
    viewclass: "Chat_Msgs"
    RecycleBoxLayout:
        default_size: None, None
        default_size_hint: 1, None
        size_hint_y: None
        orientation: 'vertical'
        height: self.minimum_height

<Chats>:
    id: Chats
    name: 'Chats'
    scrollerName: Scroll_Chats

    MDFloatLayout:
        MDFloatLayout:
            size_hint: 1, .8
            pos_hint: {'x': 0,'y': 0.2}
            Scroll_Chats:
                pos_hint: {'center_x': 0.5, 'center_y': 0.4}
                id: Scroll_Chats


        Button:
            id: TARGET_USER
            text: "USER"
            size_hint: .6, .1
            pos_hint: {'x': 0.2,'y': 0.9}

        Button:
            id: USER_STATUS
            text: "OFFLINE"
            size_hint: .2, .1
            pos_hint: {'x': 0.8,'y': 0.9}

        Button:
            id: Home
            text: "Home"
            size_hint: .5, .1
            pos_hint: {'x': 0.0,'y': 0.8}
            on_release: root.home()

        Button:
            id: CONTACTS
            text: "CONTACTS"
            disabled: False
            size_hint: .5, .1
            pos_hint: {'x': 0.5,'y': 0.8}
            on_release: root.contacts()

        Button:
            id: EXIT
            text: "EXIT"
            size_hint: .2, .1
            pos_hint: {'x': 0.0,'y': 0.9}
            on_press: root.back()


        TextInput:
            id: MSG_OUT
            size_hint: .8, .1
            pos_hint: {'x': 0.0,'y': 0.0}

        Button:
            id: SEND_IT
            text: "SEND"
            size_hint: .2, .1
            pos_hint: {'x': 0.8,'y': 0.0}
            on_press: root.send_it()

#-----------------------------------------------------------------------------------------------------
    #MAIN_PROFILE_HANDLE
<Home>:
    name: 'Home'

    #MAIN_PROFILE_SCREEN
    MDFloatLayout:
        orientation: 'vertical'

        MD_RECT_BUTTON:
            id: USER
            text: "USER"
            size_hint: .8, .1
            pos_hint: {'x': 0.2,'y': 0.9}

        MD_RECT_BUTTON:
            id: Home
            text: "Home"
            disabled: True
            size_hint: .5, .1
            pos_hint: {'x': 0.0,'y': 0.8}

        MD_RECT_BUTTON:
            id: CONTACTS
            text: "CONTACTS"
            size_hint: .5, .1
            pos_hint: {'x': 0.5,'y': 0.8}
            on_release: root.chats()

        MD_RECT_BUTTON:
            id: NEW_LOG
            text: "NEW_LOG"
            size_hint: .8, .2
            pos_hint: {'x': 0.1,'y': 0.5}
            on_press: root.new_log()

        MD_RECT_BUTTON:
            id: SEARCH_
            text: "SEARCH"
            size_hint: .8, .2
            pos_hint: {'x': 0.1,'y': 0.2}
            on_press: root.search()



        MD_RECT_BUTTON:
            text_color: (0,0,0,1)
            line_color: (69/255, 245/255, 39/255, 0.99)
            md_bg_color: (69/255, 245/255, 39/255, 0.99)

            id: EXIT
            text: "EXIT"
            size_hint: .2, .1
            pos_hint: {'x': 0.0,'y': 0.9}
            on_press: root.back()

#-----------------------------------------------------------------------------------------------------




<Login>:
    name: 'Login'
    MDScrollView:
        MDFloatLayout:
            orientation:'vertical'
            spacing: 20

            MD_RECT_BUTTON:
                text_color: (0,0,0,1)
                line_color: (69/255, 245/255, 39/255, 0.99)
                md_bg_color: (69/255, 245/255, 39/255, 0.99)

                id: BACK
                text: "BACK"
                size_hint: .08, .04
                pos_hint: {'center_x': 0.12, 'center_y': 0.95}
                on_release: root.back()


            MD_RECT_BUTTON:
                id: HEAD_LINE
                text: "LOGIN"
                size_hint: .7, .08
                pos_hint: {'center_x': 0.5, 'center_y': 0.85}



            MDTextField:
                id: REP_NAME
                hint_text: "USERNAME"
                size_hint: .8, .1
                pos_hint: {'center_x': 0.5, 'center_y': 0.7}

                active_line: False
                mode: "rectangle"
                text_color_normal: "black"
                color_mode: 'custom'
                line_color_normal: 0,0,0,1
                line_color_focus: 0,0,0,1
                hint_text_color_focus: 0,0,0,1
                hint_text_color_normal: 0,0,0,.8
                color_active: 0,0,0,1
                normal_color: 0,0,0,1
                fill_color: (20/255, 245/255, 209/255, 0.99)


            MDTextField:
                id: PSWD
                icon_left: "key-variant"
                icon_left_color: 0,0,0,1

                hint_text: "PASSWORD"
                password: True
                password_mask: "*"


                cursor_color: 0,0,0,1
                active_line: False
                mode: "rectangle"
                text_color_normal: "black"
                color_mode: 'custom'
                line_color_normal: 0,0,0,1
                line_color_focus: 0,0,0,1
                hint_text_color_focus: 0,0,0,1
                hint_text_color_normal: 0,0,0,.8
                color_active: 0,0,0,1
                normal_color: 0,0,0,1
                fill_color: (20/255, 245/255, 209/255, 0.99)

                size_hint: .8, .1
                pos_hint: {'center_x': 0.5, 'center_y': 0.55}
                #required: True


            MD_RECT_BUTTON:
                id: LOG_IN
                text: 'LOGIN'
                size_hint: .8, .1
                pos_hint: {'center_x': 0.5, 'center_y': 0.4}
                on_release: root.login_()



<Register>:
    name: 'Register'
    MDScrollView:
        MDFloatLayout:
            orientation:'vertical'

            MD_RECT_BUTTON:

                id: BACK
                text: "BACK"
                size_hint: .08, .04
                pos_hint: {'center_x': 0.12, 'center_y': 0.95}
                on_release: root.back()


            MD_RECT_BUTTON:

                id: HEAD_LINE
                text: "REGISTER"
                size_hint: .8, .1
                pos_hint: {'center_x': 0.5, 'center_y': 0.85}
                on_release: root.back()

            MDTextField:
                id: REP_NAME
                hint_text: "USERNAME"
                size_hint: .8, .1
                pos_hint: {'center_x': 0.5, 'center_y': 0.7}

                active_line: False
                mode: "rectangle"
                text_color_normal: "black"
                color_mode: 'custom'
                line_color_normal: 0,0,0,1
                line_color_focus: 0,0,0,1
                hint_text_color_focus: 0,0,0,1
                hint_text_color_normal: 0,0,0,.8
                color_active: 0,0,0,1
                normal_color: 0,0,0,1
                fill_color: (20/255, 245/255, 209/255, 0.99)


            MDTextField:
                id: PSWD
                icon_left: "key-variant"
                icon_left_color: 0,0,0,1

                hint_text: "PASSWORD"
                password: True
                password_mask: "*"


                cursor_color: 0,0,0,1
                active_line: False
                mode: "rectangle"
                text_color_normal: "black"
                color_mode: 'custom'
                line_color_normal: 0,0,0,1
                line_color_focus: 0,0,0,1
                hint_text_color_focus: 0,0,0,1
                hint_text_color_normal: 0,0,0,.8
                color_active: 0,0,0,1
                normal_color: 0,0,0,1
                fill_color: (20/255, 245/255, 209/255, 0.99)

                size_hint: .8, .1
                pos_hint: {'center_x': 0.5, 'center_y': 0.55}
                #required: True

            MD_RECT_BUTTON:

                id: REG
                text:'REGISTER'
                size_hint: .8, .1
                pos_hint: {'center_x': 0.5, 'center_y': 0.4}
                on_release: root.Register_()

#-----------------------------------------------------------------------------------------------------
    #Main_WID
<Main_WID>:
    name: "Main_WID"
    MDFloatLayout:
        orientation: 'vertical'
        md_bg_color: (25/255, 25/255, 25/255, 0.0) # RGBA_COLOR_PICKER

        MD_RECT_BUTTON:
            id: HEAD_LINE
            text:'NixLyn\nTubeChat'

            bold: True
            font_size: 24
            line_color: (0,0,0,0)
            text_color: (0,0,0,1)
            md_bg_color: (69/255, 245/255, 39/255, 0.99) # rgba(69, 245, 39, 1)
            size_hint: .8, .15
            pos_hint: {'x': 0.1,'y': 0.75}

 
        MD_RECT_BUTTON:
            text: "REGISTER"
            font_size: 25

            size_hint: .8, .1
            pos_hint: {'x': 0.1,'y': 0.5}# 0.2, .4
            on_press: root.Register()

        MD_RECT_BUTTON:
            text: "LOGIN"
            font_size: 25
            ripple_behavior: True


            size_hint: .8, .1
            pos_hint: {'x': 0.1,'y': 0.3}# 0.2, .4
            on_press: root.Login()

        MD_RECT_BUTTON:
            text: "Exit"
            font_size: 25

            size_hint: .8, .10
            pos_hint: {'x': 0.1,'y': 0.1}# 0.2, .4
            border: 30,30,30,30

            on_press: root.Exit()